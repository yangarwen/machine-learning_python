<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="pingback" href="https://dataskunkworks.com/xmlrpc.php" />

	<!-- W3TC-include-js-head -->
	<title>Predicting customer churn with Python: Logistic regression, decision trees and random forests &#8211; Data Skunkworks</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Data Skunkworks &raquo; Feed" href="https://dataskunkworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Data Skunkworks &raquo; Comments Feed" href="https://dataskunkworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Data Skunkworks &raquo; Predicting customer churn with Python: Logistic regression, decision trees and random forests Comments Feed" href="https://dataskunkworks.com/2018/06/05/predicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/dataskunkworks.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.0.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-quicklatex-format-css'  href='https://dataskunkworks.com/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=5.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='https://dataskunkworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://dataskunkworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://dataskunkworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://dataskunkworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css'  href='https://dataskunkworks.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='readable-google-fonts-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300%2C400%2C700%7CLato%3A700%2C900&#038;ver=5.0.2' type='text/css' media='all' />
<link rel='stylesheet' id='readable-main-css'  href='https://dataskunkworks.com/wp-content/themes/readable/assets/stylesheets/main.css?ver=2.1.2' type='text/css' media='all' />
<style id='readable-main-inline-css' type='text/css'>

/******************
Primary theme color
*******************/

.social__container, .search__container, .search-panel .search-panel__text, .navigation > li.current-menu-item > a, .navigation > li:hover > a, .navigation > li.current-menu-ancestor > a, .widget-contact__title, .navigation .sub-menu > li > a:hover, .error .primary-color {
	color: #0a0707}

.social .social__dropdown, .navbar-toggle, .widget_search .search-submit {
	background: #0a0707}

::selection {
	background: #0a0707}

.wpcf7-submit, .navigation > li > a:after, .btn-primary, #submitWPComment {
	background: linear-gradient(to bottom, #0a0707, #090606)
}

blockquote, .wpcf7-submit, .btn-primary, .navbar-toggle, #submitWPComment {
	border-color: #0a0707}

.search__container:hover, .social__container:hover {
	color: #090606}

@media (min-width: 992px) {
	.navigation .sub-menu > li > a {
		background: #0a0707	}
}

.wpcf7-submit:hover, .btn-primary:hover, .social .social__dropdown li a:hover, #submitWPComment:hover {
	background: #090606}

@media (min-width: 992px) {
	.navigation .sub-menu > li > a:hover {
		background: #090606	}
}

.wpcf7-submit:hover, .navigation .sub-menu > li > a, .navigation .sub-menu, .btn-primary:hover, .social .social__dropdown li .social__container, #submitWPComment:hover {
	border-color: #090606}

.format-link { background: -webkit-radial-gradient(50% 50%, circle closest-corner, #0a0707 0%, #090606 100%); background: radial-gradient(circle closest-corner at 50% 50%, #0a0707 0%, #090606 100%);}

/******************
Text color
*******************/

.post-content, .post-content--narrow, body .su-tabs-style-default .su-tabs-pane {
	color: #40454a}

/******************
Link color
*******************/

a, .menu li a, .pptwj .pptwj-tabs-wrap .tab-links li a.selected, .pptwj .pptwj-tabs-wrap .tab-links li a:hover, .pptwj .pptwj-tabs-wrap .boxes ul.tab-filter-list li a:hover, .pptwj .pptwj-tabs-wrap .boxes ul.tab-filter-list li a.selected, .pagination .prev, .pagination .next, .pagination__page-numbers .current, .latest-posts__meta-content a.latest-posts__meta-content-author-link {
	color: #51ab6d}

.widget_tag_cloud a, .tags a {
	border-color: #51ab6d}

a:hover, .menu li a:hover {
	color: #45915d}

.widget_tag_cloud a:hover, .tags a:hover, .pptwj .pptwj-tabs-wrap .boxes ul.tab-filter-list li a.selected:after, .pptwj .pptwj-tabs-wrap .boxes ul.tab-filter-list li a:hover:after {
	background-color: #51ab6d}

/******************
Headings dark
*******************/
h1, h1 a, .h1 a, .h2, h2, h2 a, .h2 a, h4, h4 a, .h4 a, h5, h5 a, .h5 a, .zem_rp_title {
	color: #2f343b}

/******************
Headings light
*******************/
h3, h3 a, .h3 a, h6, h6 a, .h6 a, .wp_rp_excerpt {
	color: #ffffff}

/******************
Navbar background
*******************/
.header {
	background-color: #ffffff}

/******************
Footer background
*******************/
.footer, .copyrights {
	background-color: #ffffff}

/******************
Navbar text color
*******************/

.navigation > li > a {
	color: #0a0a0a}

/******************
Navbar dropdown text color
*******************/

@media (min-width: 992px) {
	.navigation .sub-menu > li > a, .navigation .sub-menu > li > a:hover {
		color: #ffffff	}
}

/* WP Customizer end */


</style>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/dataskunkworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0'></script>
<link rel='https://api.w.org/' href='https://dataskunkworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://dataskunkworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://dataskunkworks.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Machine Learning from Disaster: Data exploration and feature engineering' href='https://dataskunkworks.com/2018/05/16/titanic-machine-learning-from-disaster-part-1-data-exploration-and-feature-engineering/' />
<link rel='next' title='Extracting topics from 11,000 Newsgroups posts with Python, Gensim and LDA' href='https://dataskunkworks.com/2018/06/06/extracting-topics-from-11000-newsgroups-posts-with-python-gensim-and-lda/' />
<meta name="generator" content="WordPress 5.0.2" />
<link rel="canonical" href="https://dataskunkworks.com/2018/06/05/predicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests/" />
<link rel='shortlink' href='https://dataskunkworks.com/?p=2709' />
<link rel="alternate" type="application/json+oembed" href="https://dataskunkworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdataskunkworks.com%2F2018%2F06%2F05%2Fpredicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://dataskunkworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdataskunkworks.com%2F2018%2F06%2F05%2Fpredicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests%2F&#038;format=xml" />
			<link rel="shortcut icon" href="https://dataskunkworks.com/wp-content/themes/readable/assets/images/favicon.png">
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #ffffff; }
</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="icon" href="https://dataskunkworks.com/wp-content/uploads/2018/02/cropped-icon_upload_203.221.199.234_1518234096_vq38416_created-32x32.png" sizes="32x32" />
<link rel="icon" href="https://dataskunkworks.com/wp-content/uploads/2018/02/cropped-icon_upload_203.221.199.234_1518234096_vq38416_created-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://dataskunkworks.com/wp-content/uploads/2018/02/cropped-icon_upload_203.221.199.234_1518234096_vq38416_created-180x180.png" />
<meta name="msapplication-TileImage" content="https://dataskunkworks.com/wp-content/uploads/2018/02/cropped-icon_upload_203.221.199.234_1518234096_vq38416_created-270x270.png" />
	<!-- W3TC-include-css -->
</head>

<body class="post-template-default single single-post postid-2709 single-format-standard custom-background">
<!-- W3TC-include-js-body-start -->

	<!-- Search - Open panel -->
	<div class="search-panel">
		<a href="https://dataskunkworks.com/" class="search-panel__close  js--toggle-search-mode" title="Exit the search mode"><i class="glyphicon glyphicon-remove"></i></a>
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					<form action="https://dataskunkworks.com/">
						<input type="text" class="search-panel__form  js--search-panel-text" name="s" placeholder="Begin typing for search">
						<p class="search-panel__text">Press enter to see results or esc to cancel.</p>
					</form>
				</div>
			</div>
		</div>
	</div>

	<div class="page-content-container"><!-- ends in the footer.php -->
		<!-- header -->
		<header class="header  push-down-45">
			<div class="container">
				<div class="logo  pull-left">
					<a href="https://dataskunkworks.com/">
													<h1 class="blog-name">Data Skunkworks</h1>
											</a>
				</div>

				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#readable-navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<nav class="navbar  navbar-default" role="navigation">

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse  navbar-collapse" id="readable-navbar-collapse">
						<ul id="menu-main-menu" class="navigation"><li id="menu-item-2253" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-2253"><a href="http://dataskunkworks.com">Home</a></li>
<li id="menu-item-2258" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2258"><a href="https://dataskunkworks.com/about-us/">About</a></li>
<li id="menu-item-1820" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1820"><a href="https://dataskunkworks.com/contact-us-contact-form-7/">Contact</a></li>
</ul>						<a href="#" class="search__container--mobile  js--toggle-search-mode  visible-xs  visible-sm"> <span class="glyphicon  glyphicon-search"></span></a>
					</div><!-- /.navbar-collapse -->
				</nav>
				<div class="hidden-xs  hidden-sm">
					<a href="#" class="search__container  js--toggle-search-mode"> <span class="glyphicon  glyphicon-search"></span></a>
										<div class="social">
						<a href="#" class="social__container  js--blank-link"><span class="glyphicon  glyphicon-heart"></span></a>
						<ul class="social__dropdown">
														<li>
								<a href="http://thomas@dataskunkworks.com"  class="social__container"> <span class="zocial-email"></span></a>
							</li>
														<li>
								<a href="https://www.linkedin.com/in/thomas-colin-28376784/"  class="social__container"> <span class="zocial-linkedin"></span></a>
							</li>
														<li>
								<a href="https://twitter.com/dataskunkworks"  class="social__container"> <span class="zocial-twitter"></span></a>
							</li>
													</ul>
					</div>
									</div>
			</div>
		</header>
<div class="container">
	<div class="row">
		<div class="col-xs-12  col-md-8" role="main">

			
				<!-- Post with featured image -->
				<article class="boxed push-down-45 post-2709 post type-post status-publish format-standard has-post-thumbnail hentry category-machine-learning">

					<div class="meta">

						<img width="750" height="410" src="https://dataskunkworks.com/wp-content/uploads/2018/05/1_RZ1RKBwhLxZM6SRX5Nc4Rw-1.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/1_RZ1RKBwhLxZM6SRX5Nc4Rw-1.png 750w, https://dataskunkworks.com/wp-content/uploads/2018/05/1_RZ1RKBwhLxZM6SRX5Nc4Rw-1-300x164.png 300w" sizes="(max-width: 750px) 100vw, 750px" />			
	
			
				<div class="meta__container  clearfix">
					<div class="meta__info">
						<span class="author  meta__author">
							<img alt='' src='https://secure.gravatar.com/avatar/6c68712ea66675abf4028ebff74bf3a4?s=30&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c68712ea66675abf4028ebff74bf3a4?s=60&#038;d=mm&#038;r=g 2x' class='avatar avatar-30 photo' height='30' width='30' />							<a href="https://dataskunkworks.com/author/thomas/"><span class="vcard author"><span class="fn">Thomas</span></span></a> in <a href="https://dataskunkworks.com/category/machine-learning/" rel="category tag">Machine Learning</a>
						</span>
						<time datetime="2018-06-05T15:49:33+00:00" class="meta__date  updated"><a href="https://dataskunkworks.com/2018/06/05/"><span class="glyphicon  glyphicon-calendar"></span> &nbsp; June 5, 2018</a></time>
					</div>
					<div class="meta__comments">
						<a href="https://dataskunkworks.com/2018/06/05/predicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests/#respond"><span class="glyphicon  glyphicon-comment"></span>  &nbsp; 0 Comments</a>
					</div>
				</div>

					
</div>


					<!-- Start of the blogpost -->
					<div class="row">
						<div class="col-xs-10  col-xs-offset-1">

							<!-- Start of the content -->
							<div class="post-content  post-content--narrow">
								<h1 class="entry-title  post-content__title  h2">
									Predicting customer churn with Python: Logistic regression, decision trees and random forests								</h1>
								<div class="entry-content  post-content__text">
									<p>Customer churn is when a company&#8217;s customers stop doing business with that company. Businesses are very keen on measuring churn because keeping an existing customer is far less expensive than acquiring a new customer. New business involves working leads through a sales funnel, using marketing and sales budgets to gain additional customers. Existing customers will often have a higher volume of service consumption and can generate additional customer referrals.</p>
<p><img class="aligncenter wp-image-2712 size-large" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn-1024x482.png" alt="" width="700" height="329" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn-1024x482.png 1024w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn-300x141.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn-768x362.png 768w" sizes="(max-width: 700px) 100vw, 700px" /></p>
<p>Customer retention can be achieved with good customer service and products. But the most effective way for a company to prevent attrition of customers is to truly know them. The vast volumes of data collected about customers can be used to build churn prediction models. Knowing who is most likely to defect means that a company can prioritise focused marketing efforts on that subset of their customer base.</p>
<p>Preventing customer churn is critically important to the telecommunications sector, as the barriers to entry for switching services are so low. In this post, we will examine customer data from IBM Sample Data Sets with the aim of building and comparing several customer churn prediction models. You can download the dataset <a href="https://community.watsonanalytics.com/wp-content/uploads/2015/03/WA_Fn-UseC_-Telco-Customer-Churn.csv">here.</a></p>
<h2>Data preparation</h2>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7c3575597702" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pandas as pd

import matplotlib.pyplot as plt
import seaborn as sns

data = pd.read_csv('...input\\churn.csv')
data.head()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7c3575597702-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7c3575597702-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a7c3575597702-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7c3575597702-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a7c3575597702-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7c3575597702-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a7c3575597702-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7c3575597702-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7c3575597702-2">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a7c3575597702-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7c3575597702-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">seaborn </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">sns</span></div><div class="crayon-line" id="crayon-5c1cefa87a7c3575597702-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7c3575597702-6"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'...input\\churn.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7c3575597702-7"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p><img class="wp-image-2713 size-full alignnone" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn2.png" alt="" width="1003" height="293" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn2.png 1003w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn2-300x88.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn2-768x224.png 768w" sizes="(max-width: 1003px) 100vw, 1003px" /></p>
<h4>What does the data look like?</h4>
<p>Each row gives details for all of the 7,034 individual customers, e.g. the length of their tenure, internet service type, contract type, monthly charges. The target for prediction is the &#8216;Churn&#8217; column, indicating whether or not the customer cancelled their service.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7ce464735903" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#Find blanks in data
data.info()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7ce464735903-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7ce464735903-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7ce464735903-1"><span class="crayon-c">#Find blanks in data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7ce464735903-2"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">info</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><img class="size-full wp-image-2714 alignnone" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn3.png" alt="" width="334" height="457" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn3.png 334w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn3-219x300.png 219w" sizes="(max-width: 334px) 100vw, 334px" /></p>
<p>Pandas didn&#8217;t detect all of the values in the &#8216;TotalCharges&#8217; column to be float64 type, so we probably have some non-numeric data in the column.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7d6933785739" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data['TotalCharges'] = pd.to_numeric(data['TotalCharges'], errors = 'coerce')
data.loc[data['TotalCharges'].isna()==True]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7d6933785739-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7d6933785739-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7d6933785739-1"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'TotalCharges'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">to_numeric</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'TotalCharges'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'coerce'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7d6933785739-2"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">loc</span><span class="crayon-sy">[</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'TotalCharges'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">isna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">==</span><span class="crayon-t">True</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p><img class="size-full wp-image-2715 alignnone" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn4.png" alt="" width="810" height="534" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn4.png 810w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn4-300x198.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn4-768x506.png 768w" sizes="(max-width: 810px) 100vw, 810px" /><br />
Looks like the blank &#8216;TotalCharges&#8217; values were for customers with 0 months tenure. We will adjust these values to $0.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7da323251516" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data[data['TotalCharges'].isna()==True] = 0
data['OnlineBackup'].unique()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7da323251516-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7da323251516-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7da323251516-1"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'TotalCharges'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">isna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">==</span><span class="crayon-t">True</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7da323251516-2"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'OnlineBackup'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">unique</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><img class="size-full wp-image-2716 alignnone" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn5.png" alt="" width="472" height="26" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn5.png 472w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn5-300x17.png 300w" sizes="(max-width: 472px) 100vw, 472px" /></p>
<p>Next we&#8217;ll convert the categorical values into numeric values, so our ML algorithms can process the data. We will also remove the columns not used in the predictive model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7de826520764" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data['gender'].replace(['Male','Female'],[0,1],inplace=True)
data['Partner'].replace(['Yes','No'],[1,0],inplace=True)
data['Dependents'].replace(['Yes','No'],[1,0],inplace=True)
data['PhoneService'].replace(['Yes','No'],[1,0],inplace=True)
data['MultipleLines'].replace(['No phone service','No', 'Yes'],[0,0,1],inplace=True)
data['InternetService'].replace(['No','DSL','Fiber optic'],[0,1,2],inplace=True)
data['OnlineSecurity'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['OnlineBackup'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['DeviceProtection'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['TechSupport'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['StreamingTV'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['StreamingMovies'].replace(['No','Yes','No internet service'],[0,1,0],inplace=True)
data['Contract'].replace(['Month-to-month', 'One year', 'Two year'],[0,1,2],inplace=True)
data['PaperlessBilling'].replace(['Yes','No'],[1,0],inplace=True)
data['PaymentMethod'].replace(['Electronic check', 'Mailed check', 'Bank transfer (automatic)','Credit card (automatic)'],[0,1,2,3],inplace=True)
data['Churn'].replace(['Yes','No'],[1,0],inplace=True)

data.pop('customerID')
data.info()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-12">12</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-14">14</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-16">16</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7de826520764-18">18</div><div class="crayon-num" data-line="crayon-5c1cefa87a7de826520764-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-1"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'gender'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Male'</span><span class="crayon-sy">,</span><span class="crayon-s">'Female'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-2"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Partner'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-3"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Dependents'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-4"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'PhoneService'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-5"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'MultipleLines'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No phone service'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Yes'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-6"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'InternetService'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'DSL'</span><span class="crayon-sy">,</span><span class="crayon-s">'Fiber optic'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-7"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'OnlineSecurity'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-8"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'OnlineBackup'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-9"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'DeviceProtection'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-10"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'TechSupport'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-11"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'StreamingTV'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-12"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'StreamingMovies'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'No'</span><span class="crayon-sy">,</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No internet service'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-13"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Contract'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Month-to-month'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'One year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Two year'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-14"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'PaperlessBilling'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-15"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'PaymentMethod'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Electronic check'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mailed check'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Bank transfer (automatic)'</span><span class="crayon-sy">,</span><span class="crayon-s">'Credit card (automatic)'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-16"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Yes'</span><span class="crayon-sy">,</span><span class="crayon-s">'No'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7de826520764-18"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'customerID'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7de826520764-19"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">info</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0073 seconds] -->
<p><img class="alignnone size-full wp-image-2717" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn6.png" alt="" width="325" height="430" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn6.png 325w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn6-227x300.png 227w" sizes="(max-width: 325px) 100vw, 325px" /></p>
<h4 id="Correlations-between-customer-data-features-and-customer-churn">Correlations between customer data features and customer churn</h4>
<p>To decide which features of the data to include in our predictive churn model, we&#8217;ll examine the correlation between churn and each customer feature.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7e5069439910" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
corr = data.corr()
sns.heatmap(corr, xticklabels=corr.columns.values, yticklabels=corr.columns.values, annot = True, annot_kws={'size':12})
heat_map=plt.gcf()
heat_map.set_size_inches(20,15)
plt.xticks(fontsize=10)
plt.yticks(fontsize=10)
plt.show()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7e5069439910-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7e5069439910-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a7e5069439910-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7e5069439910-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a7e5069439910-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7e5069439910-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a7e5069439910-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7e5069439910-1"><span class="crayon-v">corr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">corr</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7e5069439910-2"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">heatmap</span><span class="crayon-sy">(</span><span class="crayon-v">corr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xticklabels</span><span class="crayon-o">=</span><span class="crayon-v">corr</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yticklabels</span><span class="crayon-o">=</span><span class="crayon-v">corr</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">annot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">annot_kws</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'size'</span><span class="crayon-o">:</span><span class="crayon-cn">12</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7e5069439910-3"><span class="crayon-v">heat_map</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">gcf</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7e5069439910-4"><span class="crayon-v">heat_map</span><span class="crayon-sy">.</span><span class="crayon-e">set_size_inches</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7e5069439910-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7e5069439910-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">yticks</span><span class="crayon-sy">(</span><span class="crayon-v">fontsize</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7e5069439910-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p><img class="alignnone size-full wp-image-2718" src="http://dataskunkworks.com/wp-content/uploads/2018/05/churn7.png" alt="" width="1002" height="806" srcset="https://dataskunkworks.com/wp-content/uploads/2018/05/churn7.png 1002w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn7-300x241.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/05/churn7-768x618.png 768w" sizes="(max-width: 1002px) 100vw, 1002px" /></p>
<h4 id="Avoiding-multicollinearity">Avoiding multicollinearity</h4>
<p>Total charges and monthly charges are highly correlated. We try to avoid strongly correlated explanatory variables in regression models. Correlation of explanatory variables is known as multicollinearity, and perfect multicollinearity occurs when the correlation between two independent variables is equal to 1 or -1.</p>
<p>To more intuitively understand why multicollinearity is a problem for estimating regression coefficients, <a href="https://stats.stackexchange.com/questions/1149/is-there-an-intuitive-explanation-why-multicollinearity-is-a-problem-in-linear-r">this post</a> provides the following explanation:</p>
<blockquote><p>Two people are pushing a boulder up a hill. You want to know how hard each of them is pushing. Suppose that you watch them push together for ten minutes and the boulder moves 10 feet. Did the first guy do all the work and the second just fake it? Or vice versa? Or 50-50? Since both forces are working at the exact same time, you can&#8217;t separate the strength of either one separately. All that you can say is that their combined force is 1 foot per minute.</p>
<p>Now imagine that the first guy pushes for a minute himself, then nine minutes with the second guy, and a final minute is just the second guy pushing. Now you can use estimates of forces in the first and last minutes to figure out each person&#8217;s force separately. Even though they are still largely working at the same time, the fact that there is a bit of difference lets you get estimates of the force for each.</p>
<p>If you saw each man pushing independently for a full ten minutes, that would give you more precise estimates of the forces than if there is a large overlap in the forces.</p></blockquote>
<p>To avoid unstable estimates of coeffiecients in our models, we will drop the &#8216;TotalCharges&#8217; variable, as it is highly correlated to both &#8216;Tenure&#8217; and &#8216;MonthlyCharges&#8217;.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7e9368076909" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data.pop('TotalCharges')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7e9368076909-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7e9368076909-1"><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'TotalCharges'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2 id="Predictive-modelling">Predictive modelling</h2>
<p>We will consider several different models to predict customer churn. To ensure we are not over-fitting to our data, we will split the 7,043 customer records into a training and test set, with the test set being 25% of the total records.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7f1945159341" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.model_selection import train_test_split, 
train, test = train_test_split(data, test_size = 0.25)

train_y = train['Churn']
test_y = test['Churn']

train_x = train
train_x.pop('Churn')
test_x = test
test_x.pop('Churn')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7f1945159341-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f1945159341-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f1945159341-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f1945159341-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f1945159341-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f1945159341-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f1945159341-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f1945159341-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f1945159341-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f1945159341-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7f1945159341-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">train_test_split</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f1945159341-2"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f1945159341-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f1945159341-4"><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f1945159341-5"><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f1945159341-6">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a7f1945159341-7"><span class="crayon-v">train_x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f1945159341-8"><span class="crayon-v">train_x</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f1945159341-9"><span class="crayon-v">test_x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f1945159341-10"><span class="crayon-v">test_x</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<h4 id="Logistic-regression">Logistic regression</h4>
<p>Logistic regression is one of the more basic classification algorithms in a data scientist’s toolkit. It is used to predict a category or group based on an observation. Logistic regression is usually used for binary classification (1 or 0, win or lose, true or false). The output of logistic regression is a probability, which will always be a value between 0 and 1. While the output value does not give a classification directly, we can choose a cutoff value so that inputs with with probability greater than the cutoff belong to one class, and those with less than the cutoff belong to the other.</p>
<p>For example, if the classifier predicts a probability of customer attrition being 70%, and our cutoff value is 50%, then we predict that the customer will churn. Similarly, if the model outputs a 30% chance of attrition for a customer, then we predict that the customer won&#8217;t churn. See <a href="https://en.wikipedia.org/wiki/Logistic_regression">here</a> for a more detailed look into the mathematics and assumptions of logistic regression.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7f5853131736" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import confusion_matrix, classification_report

logisticRegr = LogisticRegression()
logisticRegr.fit(X=train_x, y=train_y)

test_y_pred = logisticRegr.predict(test_x)
confusion_matrix = confusion_matrix(test_y, test_y_pred)
print('Intercept: ' + str(logisticRegr.intercept_))
print('Regression: ' + str(logisticRegr.coef_))
print('Accuracy of logistic regression classifier on test set: {:.2f}'.format(logisticRegr.score(test_x, test_y)))
print(classification_report(test_y, test_y_pred))

confusion_matrix_df = pd.DataFrame(confusion_matrix, ('No churn', 'Churn'), ('No churn', 'Churn'))
heatmap = sns.heatmap(confusion_matrix_df, annot=True, annot_kws={"size": 20}, fmt="d")
heatmap.yaxis.set_ticklabels(heatmap.yaxis.get_ticklabels(), rotation=0, ha='right', fontsize = 14)
heatmap.xaxis.set_ticklabels(heatmap.xaxis.get_ticklabels(), rotation=45, ha='right', fontsize = 14)
plt.ylabel('True label', fontsize = 14)
plt.xlabel('Predicted label', fontsize = 14)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-12">12</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-14">14</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-16">16</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a7f5853131736-18">18</div><div class="crayon-num" data-line="crayon-5c1cefa87a7f5853131736-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">confusion_matrix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">classification_report</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-4"><span class="crayon-v">logisticRegr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-5"><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">train_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">train_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-6">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-7"><span class="crayon-v">test_y_pred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-8"><span class="crayon-v">confusion_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">confusion_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_pred</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Intercept: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-v">intercept_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-10"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Regression: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy of logistic regression classifier on test set: {:.2f}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">classification_report</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_pred</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-14"><span class="crayon-v">confusion_matrix_df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">confusion_matrix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'No churn'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'No churn'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-15"><span class="crayon-v">heatmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">heatmap</span><span class="crayon-sy">(</span><span class="crayon-v">confusion_matrix_df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">annot</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">annot_kws</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">"size"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fmt</span><span class="crayon-o">=</span><span class="crayon-s">"d"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-16"><span class="crayon-v">heatmap</span><span class="crayon-sy">.</span><span class="crayon-v">yaxis</span><span class="crayon-sy">.</span><span class="crayon-e">set_ticklabels</span><span class="crayon-sy">(</span><span class="crayon-v">heatmap</span><span class="crayon-sy">.</span><span class="crayon-v">yaxis</span><span class="crayon-sy">.</span><span class="crayon-e">get_ticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ha</span><span class="crayon-o">=</span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-17"><span class="crayon-v">heatmap</span><span class="crayon-sy">.</span><span class="crayon-v">xaxis</span><span class="crayon-sy">.</span><span class="crayon-e">set_ticklabels</span><span class="crayon-sy">(</span><span class="crayon-v">heatmap</span><span class="crayon-sy">.</span><span class="crayon-v">xaxis</span><span class="crayon-sy">.</span><span class="crayon-e">get_ticklabels</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ha</span><span class="crayon-o">=</span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a7f5853131736-18"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'True label'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a7f5853131736-19"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Predicted label'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0050 seconds] -->
<p><img class="alignnone size-full wp-image-2724" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn10.png" alt="" width="627" height="243" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn10.png 627w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn10-300x116.png 300w" sizes="(max-width: 627px) 100vw, 627px" /><img class="alignnone size-full wp-image-2725" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn11.png" alt="" width="453" height="321" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn11.png 453w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn11-300x213.png 300w" sizes="(max-width: 453px) 100vw, 453px" /></p>
<p>We got 81% classification accuracy from our logistic regression classifier. But the precision and recall for predictions in the positive class (churn) are relatively low, which suggests our data set may be imbalanced.</p>
<h4 id="How-to-handle-imbalanced-classes">How to handle imbalanced classes</h4>
<p>It is also important to look at the distribution of how many customers churn. If 95% of customers don&#8217;t churn, we can achieve 95% accuracy by building a model that simply predicts that all customers won&#8217;t churn. But this isn&#8217;t a very useful model, because it will never tell us when a customer will churn, which is what we are really interested in.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a7f9611837595" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data['Churn'].value_counts()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a7f9611837595-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a7f9611837595-1"><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">value_counts</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><img class="alignnone size-full wp-image-2726" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn12.png" alt="" width="524" height="71" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn12.png 524w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn12-300x41.png 300w" sizes="(max-width: 524px) 100vw, 524px" /></p>
<p>The class for churn is only around 25% of the total population of samples. There is a real risk that a model trained on this data may only make too many predictions in favour of the majority class. There are a number of techniques for handling imbalanced classes:</p>
<h4>Up-sampling the minority class</h4>
<p>To balance the data set, we can randomly duplicate observations from the minority class. This is also known as re sampling with replacement:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a802345538124" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.utils import resample

data_majority = data[data['Churn']==0]
data_minority = data[data['Churn']==1]

data_minority_upsampled = resample(data_minority,
replace=True,
n_samples=5174, #same number of samples as majority classe
random_state=1) #set the seed for random resampling
# Combine resampled results
data_upsampled = pd.concat([data_majority, data_minority_upsampled])

data_upsampled['Churn'].value_counts()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a802345538124-12">12</div><div class="crayon-num" data-line="crayon-5c1cefa87a802345538124-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a802345538124-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">resample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-2">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-3"><span class="crayon-v">data_majority</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-4"><span class="crayon-v">data_minority</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-6"><span class="crayon-v">data_minority_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">resample</span><span class="crayon-sy">(</span><span class="crayon-v">data_minority</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-7"><span class="crayon-v">replace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-8"><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">5174</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">#same number of samples as majority classe</span></div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-9"><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">#set the seed for random resampling</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-10"><span class="crayon-c"># Combine resampled results</span></div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-11"><span class="crayon-v">data_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">data_majority</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data_minority_upsampled</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a802345538124-12">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a802345538124-13"><span class="crayon-v">data_upsampled</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">value_counts</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p><img class="alignnone size-full wp-image-2727" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn13.png" alt="" width="508" height="63" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn13.png 508w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn13-300x37.png 300w" sizes="(max-width: 508px) 100vw, 508px" /></p>
<p>Now that we have a 1:1 ratio for our classes, let&#8217;s train another logistic regression model:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a806197332892" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
train, test = train_test_split(data_upsampled, test_size = 0.25)

train_y_upsampled = train['Churn']
test_y_upsampled = test['Churn']

train_x_upsampled = train
train_x_upsampled.pop('Churn')
test_x_upsampled = test
test_x_upsampled.pop('Churn')

logisticRegr_balanced = LogisticRegression()
logisticRegr_balanced.fit(X=train_x_upsampled, y=train_y_upsampled)

test_y_pred_balanced = logisticRegr_balanced.predict(test_x_upsampled)
print('Accuracy of logistic regression classifier on test set: {:.2f}'.format(logisticRegr_balanced.score(test_x_upsampled, test_y_upsampled)))
print(classification_report(test_y_upsampled, test_y_pred_balanced))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-12">12</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-14">14</div><div class="crayon-num" data-line="crayon-5c1cefa87a806197332892-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a806197332892-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a806197332892-1"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">data_upsampled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-2">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-3"><span class="crayon-v">train_y_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-4"><span class="crayon-v">test_y_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">[</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-6"><span class="crayon-v">train_x_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train</span></div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-7"><span class="crayon-v">train_x_upsampled</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-8"><span class="crayon-v">test_x_upsampled</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span></div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-9"><span class="crayon-v">test_x_upsampled</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-s">'Churn'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-10">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-11"><span class="crayon-v">logisticRegr_balanced</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-12"><span class="crayon-v">logisticRegr_balanced</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">train_x_upsampled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">train_y_upsampled</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-14"><span class="crayon-v">test_y_pred_balanced</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">logisticRegr_balanced</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_x_upsampled</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a806197332892-15"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy of logistic regression classifier on test set: {:.2f}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">logisticRegr_balanced</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">test_x_upsampled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_upsampled</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a806197332892-16"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">classification_report</span><span class="crayon-sy">(</span><span class="crayon-v">test_y_upsampled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_pred_balanced</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p><img class="alignnone size-full wp-image-2728" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn14.png" alt="" width="483" height="144" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn14.png 483w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn14-300x89.png 300w" sizes="(max-width: 483px) 100vw, 483px" /></p>
<p>The overall accuracy of the model has decreased, but the precision and recall scores for predicting a churn have improved. There are a number of other ways to deal with imbalanced classes, including:</p>
<h4 id="Down-sampling-the-majority-class">Down-sampling the majority class</h4>
<p>Similar to the above method, we reduce the number of samples in the majority class to be equal to the number of samples in the minority class.</p>
<h4 id="Using-a-different-performance-metric">Using a different performance metric</h4>
<p>Area Under ROC Curve (AUROC) represents the likelihood of a model distinguishing observations between two classes. In very simple terms, AUROC gives a single measure of how a model&#8217;s true positive rate and false positive rate change with different threshold values. The closer a model&#8217;s AUROC score is to 1, the better it is. To calculate AUROC, we need the predicted class probabilities:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a80a869397869" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.metrics import roc_auc_score

# Get class probabilities for both models
test_y_prob = logisticRegr.predict_proba(test_x)
test_y_prob_balanced = logisticRegr_balanced.predict_proba(test_x_upsampled)

# We only need the probabilities for the positive class
test_y_prob = [p[1] for p in test_y_prob]
test_y_prob_balanced = [p[1] for p in test_y_prob_balanced]

print('Unbalanced model AUROC: ' + str(roc_auc_score(test_y, test_y_prob)))
print('Balanced model AUROC: ' + str(roc_auc_score(test_y_upsampled, test_y_prob_balanced)))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a80a869397869-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a80a869397869-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">roc_auc_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-2">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-3"><span class="crayon-c"># Get class probabilities for both models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-4"><span class="crayon-v">test_y_prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">logisticRegr</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-5"><span class="crayon-v">test_y_prob_balanced</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">logisticRegr_balanced</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">test_x_upsampled</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-6">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-7"><span class="crayon-c"># We only need the probabilities for the positive class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-8"><span class="crayon-v">test_y_prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_y_prob</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-9"><span class="crayon-v">test_y_prob_balanced</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_y_prob_balanced</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-10">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a80a869397869-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Unbalanced model AUROC: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">roc_auc_score</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_prob</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a80a869397869-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Balanced model AUROC: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">roc_auc_score</span><span class="crayon-sy">(</span><span class="crayon-v">test_y_upsampled</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y_prob_balanced</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p><img class="alignnone size-full wp-image-2729" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn15.png" alt="" width="647" height="47" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn15.png 647w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn15-300x22.png 300w" sizes="(max-width: 647px) 100vw, 647px" /></p>
<p>Interestingly, the AUROC scores are very similar between the two models. Both are above 0.5 however, suggesting that both models have the ability to distiguish between observations from each class.</p>
<h4 id="Tree-based-algorithms">Tree-based algorithms</h4>
<p>Using tree-based algorithms such as decision trees or random forests can result in good models for unbalanced datasets. If the minority class exists in one area of the feature space, a tree will be able to separate the class into a single node. For example, if 99% of customers who stream movies tend to churn, then a tree-based algorithm will likely pick this up. We will look at the results for two of these algorithms in the next section.</p>
<h4 id="Decision-Trees">Decision Trees</h4>
<p>A decision tree is a supervised learning method that makes a prediction by learning simple decision rules from the explanatory variables. Decision trees have the following advantages:</p>
<ul>
<li>Trees can be visualised, which makes them easy to interpret</li>
<li>They can handle numerical and categorical data</li>
<li>We can easily validate the model using statistical tests</li>
</ul>
<p>The downsides to decision trees:</p>
<ul>
<li>Decision trees are very prone to overfitting the training data, and often do not generalise well</li>
<li>Small variations in the training data can cause a completely different tree to be generated</li>
<li>Decision tree learning algorithms are based on heuristic algorithms like the greedy algorithm, which make locally optimal decisions at each node. These algorithms cannot guarantee a globally optimal decision tree</li>
</ul>
<p>Despite their downsides, decision trees can be a good starting point for developing predictive models that generalise better, like random forests.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a813411679795" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn import tree
from sklearn import tree
import graphviz 

# Create each decision tree (pruned and unpruned)
decisionTree_unpruned = tree.DecisionTreeClassifier()
decisionTree = tree.DecisionTreeClassifier(max_depth = 4)

# Fit each tree to our training data
decisionTree_unpruned = decisionTree_unpruned.fit(X=train_x, y=train_y)
decisionTree = decisionTree.fit(X=train_x, y=train_y)

# Generate PDF visual of decision tree
churnTree = tree.export_graphviz(decisionTree, out_file=None, 
                         feature_names = list(train_x.columns.values),  
                         class_names = ['No churn', 'Churn'],
                         filled=True, rounded=True,  
                         special_characters=True)  
graph = graphviz.Source(churnTree)
graph.render('decision_tree.gv', view=True)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-4">4</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-6">6</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-8">8</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-10">10</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-12">12</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-14">14</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-16">16</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-18">18</div><div class="crayon-num" data-line="crayon-5c1cefa87a813411679795-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a813411679795-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a813411679795-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sklearn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sklearn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tree</span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">graphviz</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-4">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-5"><span class="crayon-c"># Create each decision tree (pruned and unpruned)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-6"><span class="crayon-v">decisionTree_unpruned</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-sy">.</span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-7"><span class="crayon-v">decisionTree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-sy">.</span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-8">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-9"><span class="crayon-c"># Fit each tree to our training data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-10"><span class="crayon-v">decisionTree_unpruned</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">decisionTree_unpruned</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">train_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">train_y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-11"><span class="crayon-v">decisionTree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">decisionTree</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">train_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-v">train_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-12">&nbsp;</div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-13"><span class="crayon-c"># Generate PDF visual of decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-14"><span class="crayon-v">churnTree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-sy">.</span><span class="crayon-e">export_graphviz</span><span class="crayon-sy">(</span><span class="crayon-v">decisionTree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_file</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">feature_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">train_x</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">class_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'No churn'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Churn'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">filled</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rounded</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">special_characters</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5c1cefa87a813411679795-19"><span class="crayon-v">graph</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">graphviz</span><span class="crayon-sy">.</span><span class="crayon-e">Source</span><span class="crayon-sy">(</span><span class="crayon-v">churnTree</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a813411679795-20"><span class="crayon-v">graph</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-s">'decision_tree.gv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">view</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p><figure id="attachment_2731" style="width: 2273px" class="wp-caption alignnone"><a href="http://dataskunkworks.com/wp-content/uploads/2018/06/churn16.png"><img class="wp-image-2731 size-full" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn16.png" alt="" width="2273" height="599" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn16.png 2273w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn16-300x79.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn16-768x202.png 768w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn16-1024x270.png 1024w" sizes="(max-width: 2273px) 100vw, 2273px" /></a><figcaption class="wp-caption-text">Click on the image to see the detail in the nodes of the tree</figcaption></figure></p>
<h4 id="Trimming-the-tree">Trimming the tree</h4>
<p>We have set the maximum depth of the tree to 4 in the above example. The other variable controlling the size of the tree is &#8216;min_samples_leaf&#8217;, which specifies the minimum number of samples required to split an internal node. The default depth and minimum samples per leaf are set to unlimited, which leads to fully grown and unpruned trees, like this:</p>
<figure id="attachment_2735" style="width: 700px" class="wp-caption alignnone"><img class="wp-image-2735 size-large" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn17-1024x245.png" alt="" width="700" height="167" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn17-1024x245.png 1024w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn17-300x72.png 300w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn17-768x184.png 768w" sizes="(max-width: 700px) 100vw, 700px" /><figcaption class="wp-caption-text">The fully unpruned tree was actually too large to render on a single PDF page</figcaption></figure>
<p>An unpruned tree is effectively trying to sort every training example &#8216;perfectly&#8217; into its own leaf. We will get very good &#8216;accuracy&#8217; when testing against the training set, but it is likely that the model is over fitted. Let&#8217;s see what kind of accuracy each of the trees get on test and training sets:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a818375850916" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
test_y_pred_dt = decisionTree.predict(test_x)
print('Accuracy of decision tree classifier on test set: {:.2f}'.format(decisionTree.score(test_x, test_y)))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a818375850916-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a818375850916-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a818375850916-1"><span class="crayon-v">test_y_pred_dt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">decisionTree</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a818375850916-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy of decision tree classifier on test set: {:.2f}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">decisionTree</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p><img class="alignnone size-full wp-image-2736" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn18.png" alt="" width="739" height="78" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn18.png 739w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn18-300x32.png 300w" sizes="(max-width: 739px) 100vw, 739px" /></p>
<p>Exactly as we suspected! The unpruned tree gets a perfect score on the training set, but a relatively lower score (73%) on the test set. Our pruned tree is less accurate on the training set, but performs better when presented with the out-of-sample test data.</p>
<h4>Random forests</h4>
<p>Random forests are an ensemble learning method, where the results from multiple decision trees are combined to make a final prediction. For example, a random forest may be made up of 10 decision trees, 7 of which make a prediction for &#8216;churn&#8217; and 3 of which make a prediction for &#8216;no churn&#8217;. The final prediction for the forest will be &#8216;churn&#8217;.</p>
<p>Tree ensembles have become very popular due to their impressive performance on many real world problems.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c1cefa87a820894768858" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from sklearn.ensemble import RandomForestClassifier
randomForest = RandomForestClassifier()
randomForest.fit(train_x, train_y)
print('Accuracy of random forest classifier on test set: {:.2f}'.format(randomForest.score(test_x, test_y)))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c1cefa87a820894768858-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a820894768858-2">2</div><div class="crayon-num" data-line="crayon-5c1cefa87a820894768858-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c1cefa87a820894768858-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c1cefa87a820894768858-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a820894768858-2"><span class="crayon-v">randomForest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c1cefa87a820894768858-3"><span class="crayon-v">randomForest</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c1cefa87a820894768858-4"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy of random forest classifier on test set: {:.2f}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">randomForest</span><span class="crayon-sy">.</span><span class="crayon-e">score</span><span class="crayon-sy">(</span><span class="crayon-v">test_x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p><img class="alignnone size-full wp-image-2738" src="http://dataskunkworks.com/wp-content/uploads/2018/06/churn19.png" alt="" width="541" height="34" srcset="https://dataskunkworks.com/wp-content/uploads/2018/06/churn19.png 541w, https://dataskunkworks.com/wp-content/uploads/2018/06/churn19-300x19.png 300w" sizes="(max-width: 541px) 100vw, 541px" /></p>
<p>Looks like we get similar performance to our pruned decision tree with a random forest. The next step would be to run several more rounds of <a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)"><strong>cross validation</strong></a> using different training and testing sets to measure the performance of each of the models. We would then average the results from all rounds of cross validation to estimate the accuracy of each machine learning model.</p>
<p><strong>Conclusion</strong></p>
<p>Predicting customer churn with machine learning presents many interesting challenges. Building the best predictive model means having a good understanding of the underlying data. Different models can be implemented and tested relatively quickly using the Python sklearn package.</p>
								</div>

															</div>
							<!-- End of the content -->

							<div class="post-content-meta   post-content-meta--narrow">
								<div class="row">
									<div class="col-xs-12  push-down-60">
										<!-- Start of post author -->
										<div class="post-author">
											<h6>Written By</h6>
											<hr>
											<img alt='' src='https://secure.gravatar.com/avatar/6c68712ea66675abf4028ebff74bf3a4?s=90&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c68712ea66675abf4028ebff74bf3a4?s=180&#038;d=mm&#038;r=g 2x' class='avatar avatar-90 photo' height='90' width='90' />											<h5>
												<a href="https://dataskunkworks.com/author/thomas/"><span class="vcard author"><span class="fn">Thomas</span></span></a>
											</h5>
											<div class="post-author__text">
																							</div>
										</div>
										<!-- End of post author -->
									</div>

									
								</div>

								<div id="comments">
									<!-- comments start -->
									
<div class="comments  push-down-30">
	<h6>Comments</h6>
	<hr>

	<section class="comments-container">
		
			
			
										
					<h3 class="push-down-25">
						Leave a Comment					</h3>


					<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/06/05/predicting-customer-churn-with-python-logistic-regression-decision-trees-and-random-forests/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://dataskunkworks.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
				<p class="push-down-15"><label for="message">Message <span class="warning">*</span></label><textarea class="form-control form-control--contact form-control--big" id="comment" name="comment" rows="7" aria-required="true" placeholder="Your Comment goes here." required></textarea></p><p class="push-down-15"><label for="author">Name <span class="warning">*</span><input class="form-control  form-control--contact" id="author" name="author" type="text" value="" size="30" aria-required='true' required /></label></p>
<p class="push-down-15"><label for="email">Email <span class="warning">*</span><input class="form-control  form-control--contact" id="email" name="email" type="email" value="" size="30" aria-required='true' required /></label></p>
<p class="push-down-15"><label for="url">Website<input class="form-control  form-control--contact" id="url" name="url" type="text" value="" size="30" /></label></p>
<p class="form-submit"><input name="submit" type="submit" id="submitWPComment" class="submit" value="Send now" /> <input type='hidden' name='comment_post_ID' value='2709' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>			</form>
			</div><!-- #respond -->
		</section>
</div>									<!-- comments end -->
								</div>

															</div>
						</div>
					</div>
				</article>

			
	</div>

	
	</div>
</div>


		<footer class="footer">
			<div class="container">
				<div class="row">
					<div class="col-xs-12  col-md-3  push-down-30"><div class="widget_text"><h6>Data Skunkworks</h6><hr>			<div class="textwidget"><span class="footer__text">Experiments in data science and the visual display of quantitative information</span> </div>
		</div></div><div class="col-xs-12  col-md-3  push-down-30"><div class="widget_nav_menu"><h6>Navigation</h6><hr><div class="menu-footer-menu-container"><ul id="menu-footer-menu" class="menu"><li id="menu-item-2263" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2263"><a href="https://dataskunkworks.com/">Home</a></li>
<li id="menu-item-2259" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2259"><a href="https://dataskunkworks.com/about-us/">About me</a></li>
<li id="menu-item-1878" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1878"><a href="https://dataskunkworks.com/contact-us-contact-form-7/">Contact</a></li>
</ul></div></div></div><div class="col-xs-12  col-md-3  push-down-30"><div class="widget_tag_cloud"><h6>Tags</h6><hr><div class="tagcloud"><a href="https://dataskunkworks.com/tag/d3/" class="tag-cloud-link tag-link-25 tag-link-position-1" style="font-size: 8pt;" aria-label="d3 (1 item)">d3</a>
<a href="https://dataskunkworks.com/tag/game-of-thrones/" class="tag-cloud-link tag-link-26 tag-link-position-2" style="font-size: 8pt;" aria-label="game of thrones (1 item)">game of thrones</a>
<a href="https://dataskunkworks.com/tag/network-analysis/" class="tag-cloud-link tag-link-28 tag-link-position-3" style="font-size: 8pt;" aria-label="network analysis (1 item)">network analysis</a>
<a href="https://dataskunkworks.com/tag/pagerank/" class="tag-cloud-link tag-link-29 tag-link-position-4" style="font-size: 8pt;" aria-label="pagerank (1 item)">pagerank</a>
<a href="https://dataskunkworks.com/tag/tableau/" class="tag-cloud-link tag-link-27 tag-link-position-5" style="font-size: 8pt;" aria-label="tableau (1 item)">tableau</a></div>
</div></div><div class="col-xs-12  col-md-3  push-down-30"><div class="widget_text"><h6>Contact</h6><hr>			<div class="textwidget"><span class="widget-contact__text">
<span class="widget-contact__title">Contact</span>
<A HREF="https://www.linkedin.com/in/thomas-colin-28376784/" >LinkedIn</A>
<A HREF="https://twitter.com/dataskunkworks" >Twitter</A><br>

</span></div>
		</div></div>				</div>
			</div>
		</footer>
		<footer class="copyrights">
			<div class="container">
				<div class="row">
					<div class="col-xs-12  col-sm-6">
											</div>
					<div class="col-xs-12  col-sm-6">
						<div class="copyrights--right">
													</div>
					</div>
				</div>
			</div>
		</footer>

	</div><!-- /.page-content-container -->


<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/ui/core.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/ui/widget.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/ui/mouse.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/jquery/ui/sortable.min.js?ver=1.11.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/dataskunkworks.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}}};
/* ]]> */
</script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.1'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/underscore.min.js?ver=1.8.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ReadableVars = {"pathToTheme":"https:\/\/dataskunkworks.com\/wp-content\/themes\/readable"};
/* ]]> */
</script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-content/themes/readable/assets/js/main.min.js?ver=2.1.2'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/comment-reply.min.js?ver=5.0.2'></script>
<script type='text/javascript' src='https://dataskunkworks.com/wp-includes/js/wp-embed.min.js?ver=5.0.2'></script>
<!-- W3TC-include-js-body-end -->
</body>
</html>